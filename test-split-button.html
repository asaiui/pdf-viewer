<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分割ボタンテスト</title>
    <script>
        // メインアプリケーションのテスト
        function testSplitButton() {
            console.log('=== 分割ボタンテスト開始 ===');
            
            // DOM要素の確認
            const splitBtn = document.getElementById('splitBtn');
            console.log('分割ボタンが見つかりました:', !!splitBtn);
            
            if (splitBtn) {
                console.log('ボタンテキスト:', splitBtn.textContent);
                console.log('ボタンクラス:', splitBtn.className);
                console.log('ボタンが無効化されていない:', !splitBtn.disabled);
                console.log('ボタンが表示されている:', splitBtn.offsetParent !== null);
                
                // クリックイベントをシミュレート
                console.log('クリックイベントをシミュレート中...');
                splitBtn.click();
            }
            
            // グローバルオブジェクトの確認
            if (window.viewer) {
                console.log('viewerオブジェクトが存在します');
                console.log('svgViewerが存在:', !!window.viewer.svgViewer);
                
                if (window.viewer.svgViewer) {
                    console.log('toggleSplitModeメソッドが存在:', typeof window.viewer.svgViewer.toggleSplitMode === 'function');
                    console.log('現在の分割モード:', window.viewer.svgViewer.splitMode);
                }
                
                if (window.viewer.eventManager) {
                    console.log('EventManagerが存在します');
                    console.log('EventManager統計:', window.viewer.eventManager.getStats());
                }
            } else {
                console.error('viewerオブジェクトが見つかりません');
            }
            
            console.log('=== テスト終了 ===');
        }
        
        // ページ読み込み後にテスト実行
        window.addEventListener('load', () => {
            setTimeout(testSplitButton, 2000); // 2秒後に実行
        });
    </script>
</head>
<body style="font-family: Arial, sans-serif; padding: 20px;">
    <h1>分割ボタンテスト</h1>
    <p>このページは分割ボタンの動作をテストするためのものです。</p>
    <p>開発者ツールのコンソールを開いて、テスト結果を確認してください。</p>
    
    <div style="margin: 20px 0;">
        <button onclick="testSplitButton()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
            手動テスト実行
        </button>
    </div>
    
    <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;">
        <h3>テスト手順:</h3>
        <ol>
            <li>メインアプリケーション（index.html）を開く</li>
            <li>開発者ツールのコンソールを開く</li>
            <li>分割ボタンをクリックする</li>
            <li>以下のログを確認:</li>
            <ul>
                <li>「ISCPDFViewer.toggleSplitMode called」</li>
                <li>「WebPViewer.toggleSplitMode called」</li>
                <li>「New split mode: true/false」</li>
            </ul>
        </ol>
    </div>
    
    <div style="background: #fff3cd; padding: 15px; border-radius: 4px; margin: 20px 0;">
        <h3>期待される動作:</h3>
        <ul>
            <li>分割ボタンをクリックすると、コンソールにデバッグログが表示される</li>
            <li>分割モードがオンになると「分割」ボタンが「通常」に変わる</li>
            <li>分割インジケーター（左側表示/右側表示）が表示される</li>
            <li>画像が左半分または右半分のみ表示される</li>
            <li>Sキーでも同様に動作する</li>
        </ul>
    </div>
    
    <div style="background: #f8d7da; padding: 15px; border-radius: 4px; margin: 20px 0;">
        <h3>トラブルシューティング:</h3>
        <ul>
            <li>コンソールにエラーが表示される場合は、そのエラーメッセージを確認</li>
            <li>「svgViewer exists: false」の場合は、WebPViewerが正しく初期化されていない</li>
            <li>「toggleSplitMode method exists: false」の場合は、メソッドが存在しない</li>
            <li>EventManagerの統計情報で、イベントリスナーが正しく登録されているか確認</li>
        </ul>
    </div>
</body>
</html>